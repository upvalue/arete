LINK = link $(LDFLAGS) /out:$@ $**

SRCS=src/builtins.cpp src/files.cpp src/lib-sdl.cpp src/platform.cpp src/strings.cpp src/vm.cpp vendor/linenoise/linenoise.cpp src/cli.cpp src/gc.cpp src/main.cpp src/reader.cpp src/table.cpp src/writer.cpp vendor/linenoise/wcwidth.cpp src/eval.cpp src/image.cpp src/numbers.cpp src/state.cpp src/values.cpp vendor/linenoise/ConvertUTF.cpp
OBJS=src/builtins.obj src/files.obj src/lib-sdl.obj src/platform.obj src/strings.obj src/vm.obj vendor/linenoise/linenoise.obj src/cli.obj src/gc.obj src/main.obj src/reader.obj src/table.obj src/writer.obj vendor/linenoise/wcwidth.obj src/eval.obj src/image.obj src/numbers.obj src/state.obj src/values.obj vendor/linenoise/ConvertUTF.obj

# Note: Stack size has to be massively increased for bootstrap to work.
LDFLAGS = /nologo /Stack:8000000
CFLAGS = /Ivendor\linenoise /nologo /W3 /D_CRT_SECURE_NO_WARNINGS /DARETE_DEV  /DARETE_GC_STRATEGY="(ARETE_GC_SEMISPACE)" /DARETE_LOG_TAGS="(ARETE_LOG_TAG_VM)" 

.cpp.obj:
	cl $(CFLAGS) /I . /Fo$@ /c $<

all: arete.exe

arete.exe: $(OBJS)
	$(LINK)

clean:
	del $(OBJS)
	del arete.exe
